<pre style='color:#d1d1d1;background:#000000;'><span style='color:#008073; '>#</span><span style='color:#008073; '>define</span><span style='color:#008073; '> MAXNUM 1000000000</span>
<span style='color:#008073; '>#</span><span style='color:#008073; '>define</span><span style='color:#008073; '> MAXQ 100000</span>
<span style='color:#008073; '>#</span><span style='color:#008073; '>define</span><span style='color:#008073; '> LOGQ 20</span>
<span style='color:#e66170; font-weight:bold; '>struct</span> vertex <span style='color:#b060b0; '>{</span>
    <span style='color:#e66170; font-weight:bold; '>int</span> l<span style='color:#d2cd86; '>,</span>r<span style='color:#b060b0; '>;</span>
    <span style='color:#e66170; font-weight:bold; '>int</span> cnt<span style='color:#b060b0; '>;</span>
<span style='color:#b060b0; '>}</span><span style='color:#b060b0; '>;</span>
vertex tree<span style='color:#d2cd86; '>[</span>MAXQ<span style='color:#d2cd86; '>*</span>LOGQ<span style='color:#d2cd86; '>]</span><span style='color:#b060b0; '>;</span>
<span style='color:#e66170; font-weight:bold; '>int</span> curr<span style='color:#d2cd86; '>=</span><span style='color:#008c00; '>1</span><span style='color:#b060b0; '>;</span>
<span style='color:#e66170; font-weight:bold; '>void</span> update <span style='color:#d2cd86; '>(</span><span style='color:#e66170; font-weight:bold; '>int</span> ind<span style='color:#d2cd86; '>,</span> <span style='color:#e66170; font-weight:bold; '>int</span> l<span style='color:#d2cd86; '>,</span> <span style='color:#e66170; font-weight:bold; '>int</span> r<span style='color:#d2cd86; '>,</span> <span style='color:#e66170; font-weight:bold; '>int</span> c<span style='color:#d2cd86; '>)</span> <span style='color:#b060b0; '>{</span>
    <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>l<span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span>r<span style='color:#d2cd86; '>)</span> <span style='color:#b060b0; '>{</span>
        tree<span style='color:#d2cd86; '>[</span>ind<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>cnt<span style='color:#d2cd86; '>+</span><span style='color:#d2cd86; '>+</span><span style='color:#b060b0; '>;</span>
        <span style='color:#e66170; font-weight:bold; '>return</span> <span style='color:#b060b0; '>;</span>
    <span style='color:#b060b0; '>}</span>
    <span style='color:#e66170; font-weight:bold; '>int</span> mid<span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>(</span>l<span style='color:#d2cd86; '>+</span>r<span style='color:#d2cd86; '>)</span><span style='color:#d2cd86; '>/</span><span style='color:#008c00; '>2</span><span style='color:#b060b0; '>;</span>
    <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>c<span style='color:#d2cd86; '>&lt;</span><span style='color:#d2cd86; '>=</span>mid<span style='color:#d2cd86; '>)</span> <span style='color:#b060b0; '>{</span>
        <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>tree<span style='color:#d2cd86; '>[</span>ind<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>l<span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span><span style='color:#008c00; '>0</span><span style='color:#d2cd86; '>)</span> tree<span style='color:#d2cd86; '>[</span>ind<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>l<span style='color:#d2cd86; '>=</span>curr<span style='color:#d2cd86; '>+</span><span style='color:#d2cd86; '>+</span><span style='color:#b060b0; '>;</span> <span style='color:#9999a9; '>// добавяме ляво дете</span>
        update<span style='color:#d2cd86; '>(</span>tree<span style='color:#d2cd86; '>[</span>ind<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>l<span style='color:#d2cd86; '>,</span>l<span style='color:#d2cd86; '>,</span>mid<span style='color:#d2cd86; '>,</span>c<span style='color:#d2cd86; '>)</span><span style='color:#b060b0; '>;</span>
    <span style='color:#b060b0; '>}</span>
    <span style='color:#e66170; font-weight:bold; '>else</span> <span style='color:#b060b0; '>{</span>
        <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>tree<span style='color:#d2cd86; '>[</span>ind<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>r<span style='color:#d2cd86; '>=</span><span style='color:#d2cd86; '>=</span><span style='color:#008c00; '>0</span><span style='color:#d2cd86; '>)</span> tree<span style='color:#d2cd86; '>[</span>ind<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>r<span style='color:#d2cd86; '>=</span>curr<span style='color:#d2cd86; '>+</span><span style='color:#d2cd86; '>+</span><span style='color:#b060b0; '>;</span> <span style='color:#9999a9; '>// добавяме дясно дете</span>
        update<span style='color:#d2cd86; '>(</span>tree<span style='color:#d2cd86; '>[</span>ind<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>r<span style='color:#d2cd86; '>,</span>mid<span style='color:#d2cd86; '>+</span><span style='color:#008c00; '>1</span><span style='color:#d2cd86; '>,</span>r<span style='color:#d2cd86; '>,</span>c<span style='color:#d2cd86; '>)</span><span style='color:#b060b0; '>;</span>
    <span style='color:#b060b0; '>}</span>
    tree<span style='color:#d2cd86; '>[</span>ind<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>cnt<span style='color:#d2cd86; '>=</span><span style='color:#008c00; '>0</span><span style='color:#b060b0; '>;</span>
    <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>tree<span style='color:#d2cd86; '>[</span>ind<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>l<span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span><span style='color:#008c00; '>0</span><span style='color:#d2cd86; '>)</span> tree<span style='color:#d2cd86; '>[</span>ind<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>cnt<span style='color:#d2cd86; '>+</span><span style='color:#d2cd86; '>=</span>tree<span style='color:#d2cd86; '>[</span>tree<span style='color:#d2cd86; '>[</span>ind<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>l<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>cnt<span style='color:#b060b0; '>;</span>
    <span style='color:#e66170; font-weight:bold; '>if</span> <span style='color:#d2cd86; '>(</span>tree<span style='color:#d2cd86; '>[</span>ind<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>r<span style='color:#d2cd86; '>!</span><span style='color:#d2cd86; '>=</span><span style='color:#008c00; '>0</span><span style='color:#d2cd86; '>)</span> tree<span style='color:#d2cd86; '>[</span>ind<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>cnt<span style='color:#d2cd86; '>+</span><span style='color:#d2cd86; '>=</span>tree<span style='color:#d2cd86; '>[</span>tree<span style='color:#d2cd86; '>[</span>ind<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>r<span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>.</span>cnt<span style='color:#b060b0; '>;</span>
<span style='color:#b060b0; '>}</span>
</pre>
<!--Created using ToHtml.com-->